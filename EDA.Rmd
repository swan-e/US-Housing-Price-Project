---
title: "Exploratory Data Analysis"
author: "Sean Fleming"
date: "2025-04-21"
output:
  html_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(car)
library(ggplot2)
library(GGally)
library(shiny)
library(tsibble)
library(dplyr)
library(rsconnect)

# rsconnect deploy
# rsconnect::deployApp("C:/Users/seanf/Desktop/Sean's Data Sci Laptop/RStudio Git/US-Housing-Price-Project/EDA.Rmd")

# Reading in Data
house_data <- read.csv("US_House_Price.csv")

# Format Cleaning
house_data$DATE <- as.Date(house_data$DATE, format="%Y-%m-%d")
#house_data$DATE <- as.numeric(format(house_data$DATE, format="%Y.%m%d"))
```

## DataSet
We are using data from a dataset found off of kaggle.  
https://www.kaggle.com/datasets/jyotsnagurjar/factors-influencing-us-house-prices/data

```{r data set, echo = FALSE}
colnames <- data.frame(Column_Names = colnames(house_data))
colnames$Column_Names <- gsub("_", " ", colnames$Column_Names)
print(colnames)
```
Our initial data set comes with 16 variables. Because we want to analyze the effect of house prices, the home price index is our response variable (rest of the 15 are explanatory). 

Considering the dataset is given over time (from 2003 to 2022), time related statistical methods may be preferred (such as time series or random effect regression). 

## Time Series Plots
```{r interactive Time Series Plot, echo=FALSE}
data_tsibble <- house_data %>%
  mutate(Month = yearmonth(DATE)) %>%
  select(Month, house_for_sale_or_sold, unemployment_rate,
  home_price_index) %>%
  as_tsibble(index=Month)

# UI
selectInput("var_select", "Choose a variable to plot:", choices = c("house_for_sale_or_sold", "unemployment_rate", "home_price_index"))

# Render Plot from Shiny
renderPlot({
  req(input$var_select)
  
  ggplot(data_tsibble, aes(x = Month, y = .data[[input$var_select]])) + geom_line(color = "steelblue") + labs(title = paste("Time Series of", input$var_select),
         y = input$var_select, x = "Month") +
    theme_minimal()
})


# ggpairs from the GGally library
# ggpairs(house_data, progress=FALSE, main="Pairwise Scatterplots")
```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```
